@using BClasses.Models

@if ((Convert.ToInt32(Value.Split(",")[3]) == Codigo) || (Convert.ToInt32(Value.Split(",")[3]) == 0))
{
    <MudPaper @ondblclick="Pertencer" Height="70px" Width="50px" style="@($"background-color: {(Convert.ToInt32(Value.Split(",")[0]) > 15 ? "black" : Value.Split(",")[2])}")">
        <MudStack AlignItems="AlignItems.Center" Justify="Justify.Center" Style="width: 100%; height: 70px">
            <MudAvatar Size="Size.Medium" Style="background-color: white">
                @if (Value.Split(",")[1] == "Color")
                {
                    <MudImage Src="img/color.png"></MudImage>
                }
                else if (Value.Split(",")[1] == "Inverte")
                {
                    <MudIcon Icon="@Icons.Material.Filled.CompareArrows" Size="Size.Large" Style="@($"color: {Value.Split(",")[2]}")" />
                }
                else if (Value.Split(",")[1] == "Pular")
                {
                    <MudIcon Icon="@Icons.Material.Filled.Block" Size="Size.Large" Style="@($"color: {Value.Split(",")[2]}")" />
                }
                else
                {
                    <MudText Style="@($"color: {Value.Split(",")[2]}; font-weight: bolder; font-size: 14pt; text-shadow: 0px 2px black")">
                        @Value.Split(",")[1]
                    </MudText>
                }
            </MudAvatar>
        </MudStack>
    </MudPaper>
}
else
{
    <MudPaper Height="50px" Width="35px" style="background-color: red" >
        <MudStack AlignItems="AlignItems.Center" Justify="Justify.Center" Style="width: 100%; height: 50px">
            <MudAvatar Size="Size.Small" Style="background-color: black">
                <MudText Style="color: yellow; font-weight: bolder; font-size: 8pt; text-shadow: 0px 2px black">
                    UNO
                </MudText>
            </MudAvatar>
        </MudStack>
    </MudPaper>
}

@code {
    [Parameter] public string Value { get; set; } = string.Empty;
    [Parameter] public required Ambiente Tabuleiro { get; set; }
    [Parameter] public int Codigo { get; set; } = 0;
    [Parameter] public EventCallback Enviar { get; set; }

    private async Task Pertencer()
    {
        int index = Tabuleiro.Baralho.FindIndex(c => c == Value);
        if (index > -1)
        {
            Tabuleiro.Baralho[index] = $"{Value.Split(",")[0]},{Value.Split(",")[1]},{Value.Split(",")[2]},{Codigo}";
            await Enviar.InvokeAsync();
        }
    }
}